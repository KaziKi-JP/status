<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Status Page</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: #f8f9fa;
    }
    header {
        background: #222;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 1.4em;
    }
    .container {
        max-width: 900px;
        margin: 30px auto;
        padding: 20px;
    }
    .updated {
        text-align: right;
        font-size: 0.9em;
        color: #555;
        margin-bottom: 10px;
    }
    .global-status {
        padding: 15px;
        border-radius: 8px;
        color: white;
        font-size: 1.2em;
        font-weight: bold;
        text-align: center;
        margin-bottom: 25px;
    }

    /* 色付き */
    .up { background: #28a745; }
    .nomal { background: #ffc107; color: #222 !important; }
    .down { background: #dc3545; }
    .maint { background: #007bff; }

    /* 個別カード */
    .card {
        background: white;
        border-radius: 10px;
        padding: 18px;
        margin-bottom: 18px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .card-title {
        font-size: 1.2em;
        margin-bottom: 10px;
        font-weight: bold;
    }
    .status-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 6px;
        color: white;
        font-size: 0.95em;
        font-weight: bold;
    }
    .status-up { background: #28a745; }
    .status-nomal { background: #ffc107; color: #222; }
    .status-down { background: #dc3545; }
    .status-maint { background: #007bff; }

    .owner-special {
        background: #e8f0ff;
        border-left: 6px solid #4285f4;
    }
</style>
</head>
<body>

<header>Status Page</header>

<div class="container">

    <div class="updated" id="updated">最終更新: 読み込み中…</div>

    <div id="global" class="global-status">読み込み中…</div>

    <div id="cards"></div>
</div>

<script>
// -------------------------
// status.json 取得
// -------------------------
async function loadStatus() {
    try {
        const res = await fetch("status/status.json?_" + Date.now());
        const data = await res.json();

        // 最終更新
        document.getElementById("updated").textContent =
            "最終更新: " + data.updated;

        // 全体ステータス
        const global = document.getElementById("global");
        global.classList.add(data.global.status);
        global.textContent = data.global.label;

        // カード生成
        const area = document.getElementById("cards");
        area.innerHTML = "";

        for (const item of data.services) {
            const card = document.createElement("div");
            card.className = "card" + (item.special ? " owner-special" : "");

            card.innerHTML = `
                <div class="card-title">${item.name}</div>
                <span class="status-badge status-${item.status}">
                    ${item.label}
                </span>
            `;

            area.appendChild(card);
        }

    } catch (err) {
        document.getElementById("global").textContent =
            "ステータス読み込みエラー";
    }
}

loadStatus();
</script>

</body>
</html>
